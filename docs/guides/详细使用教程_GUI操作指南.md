# 📱 详细使用教程 - GUI操作指南

> **适用人群**：所有用户（包含小白）
> **前置条件**：已完成安装教程
> **项目版本**：v2.2

---

## 📋 教程说明

本教程将详细介绍GUI界面的每个功能，手把手教您如何使用本项目。

**包含内容**：
- GUI界面完整介绍
- 每个按钮的功能说明
- 常见使用场景演示
- 故障排查方法
- 高级功能使用

---

## 🖥️ 第1章：GUI界面总览

### 1.1 启动GUI

1. 确保Appium Server已启动（scripts/start_appium.bat）

2. 启动GUI程序：
   - **方式1**：双击 `damai_smart_ai.py`
   - **方式2**：命令行运行 `python damai_smart_ai.py`

3. 等待几秒，GUI界面会弹出

### 1.2 界面布局

GUI界面分为以下几个区域：

```
┌─────────────────────────────────────────────────┐
│  法律声明横幅（红色）                              │
├─────────────────────────────────────────────────┤
│                                                 │
│  📱 设备连接区                                   │
│  [ADB端口输入框] [连接设备] [断开设备]             │
│  [🏥 连接急救箱] [环境检查]                       │
│                                                 │
├─────────────────────────────────────────────────┤
│                                                 │
│  ⚙️ 配置区域                                    │
│  [关键词] [城市] [场次] [票档] 等                │
│                                                 │
├─────────────────────────────────────────────────┤
│                                                 │
│  🎯 功能选项                                    │
│  [快速抢票] [坐标抢票] [优先购] 等                │
│                                                 │
├─────────────────────────────────────────────────┤
│                                                 │
│  🎮 控制按钮                                    │
│  [开始] [停止] [重置]                           │
│                                                 │
├─────────────────────────────────────────────────┤
│                                                 │
│  📊 日志显示区（滚动文本框）                      │
│  [这里会显示详细的运行日志]                       │
│                                                 │
└─────────────────────────────────────────────────┘
```

---

## 🔌 第2章：设备连接

### 2.1 连接设备（基础流程）

**步骤**：

1. **填写ADB端口**：
   - 在 "ADB端口" 输入框中
   - 输入你的红手指云手机端口号
   - 例如：`62001`

2. **点击"连接设备"按钮**

3. **观察日志**：
   - 日志区域会显示连接进度
   - 看到类似这样的日志：
     ```
     [INFO] 正在连接ADB设备: 127.0.0.1:62001...
     [SUCCESS] ✓ ADB设备已连接
     [INFO] 正在创建WebDriver会话...
     [SUCCESS] ✓ WebDriver连接成功! (耗时: 4.66秒)
     ```

4. **连接成功标志**：
   - 日志中显示 "连接成功" 或 "WebDriver连接成功"
   - "断开设备" 按钮变为可点击状态
   - "开始" 按钮变为可用

**如果连接失败怎么办？→ 看第2.3节**

### 2.2 使用连接急救箱（推荐！）

如果连接遇到问题，**强烈推荐**使用连接急救箱！

**步骤**：

1. **点击"🏥 连接急救箱"按钮**

2. **等待诊断**：
   - 程序会自动进行5维诊断：
     1. Appium服务检测
     2. ADB连接检测
     3. WebDriver会话检测
     4. 网络连接检测
     5. 系统资源检测

3. **查看诊断结果**：
   - 会显示详细的诊断报告
   - 如果发现问题，会自动尝试修复
   - 例如：
     ```
     [INFO] 🏥 启动连接急救箱...
     [INFO] [1/5] 📱 诊断 Appium 服务
     [SUCCESS]   ✓ Appium 服务运行正常
     [INFO] [2/5] 🔧 诊断 ADB 连接
     [WARNING]   ⚠️ 检测到僵尸连接，开始清理...
     [SUCCESS]   ✓ 僵尸连接已清除
     ...
     ```

4. **根据建议操作**：
   - 如果自动修复成功，重新点击"连接设备"
   - 如果自动修复失败，查看日志中的排查指南

**急救箱能解决的问题**：
- ✅ Appium未启动 → 自动启动
- ✅ ADB僵尸连接 → 自动清理
- ✅ 端口不可达 → 提供排查指南
- ✅ WebDriver会话失效 → 检测并提示

### 2.3 连接问题排查

#### 问题1：提示"Appium服务未运行"

**原因**：Appium Server没有启动

**解决**：
1. 双击运行 `scripts/start_appium.bat`
2. 或手动在命令行运行：
   ```
   appium --address 127.0.0.1 --port 4723 --allow-cors
   ```
3. 保持Appium窗口打开
4. 重新点击"连接设备"

---

#### 问题2：提示"目标设备离线"

**原因**：
- 红手指云手机未启动
- ADB端口号错误
- 网络连接问题

**解决**：
1. **检查红手指状态**：
   - 打开红手指客户端
   - 确认云手机显示为"在线"（绿色图标）
   - 如果离线，点击"启动"按钮

2. **确认端口号**：
   - 在红手指客户端查看云手机的ADB端口号
   - 确保GUI中填写的端口号一致

3. **测试连接**：
   - 打开命令提示符
   - 运行：`adb connect 127.0.0.1:端口号`
   - 运行：`adb devices`
   - 应该看到设备显示为 "device" 状态

4. **使用急救箱**：
   - 点击"🏥 连接急救箱"
   - 查看详细的排查指南

---

#### 问题3：提示"WebDriver连接失败"

**原因**：
- UiAutomator2服务器问题
- 云手机性能不足
- 网络延迟

**解决**：
1. 重启云手机
2. 清理云手机后台应用
3. 等待片刻后重试
4. 使用急救箱诊断

### 2.4 断开设备

当需要断开连接时：

1. 点击 "停止" 按钮（如果正在运行）

2. 点击 "断开设备" 按钮

3. 等待断开完成

---

## ⚙️ 第3章：配置演出信息

### 3.1 基础配置

#### 关键词

**作用**：搜索演出的关键词

**填写示例**：
- `周杰伦` - 艺人名
- `五月天` - 乐队名
- `黎明南京演唱会` - 完整演出名
- `张学友` - 明星名

**建议**：
- ✅ 使用简短关键词（如 "周杰伦"）
- ✅ 使用艺人真名
- ❌ 避免过长或模糊的关键词

---

#### 城市

**作用**：选择演出城市

**填写示例**：
- `北京`
- `上海`
- `广州`
- `深圳`

**注意**：
- 必须填写完整的城市名（如 "北京"，不是 "BJ"）
- 部分城市需要选择（如 "北京市"）

---

#### 场次选择

**作用**：当一个演出有多个场次时，选择第几场

**选项**：
- `最早场次` - 选择时间最早的一场
- `最近场次` - 选择距离当前时间最近的一场
- `场次1` / `场次2` / `场次3` - 选择指定的第N场

**建议**：
- 如果不确定，选择 "最早场次"
- 如果知道具体要哪一场，选择 "场次N"

---

#### 票档选择

**作用**：选择票价档位

**选项**：
- `优先购` - 优先选择优先购票档
- `票档1` - 选择第1个票档（通常是最贵的）
- `票档2` - 选择第2个票档
- `票档3` - 选择第3个票档
- ...

**说明**：
- 票档序号从上到下排列
- 票档1通常是价格最高、位置最好的
- 优先购需要满足购买条件

---

#### 购票数量

**作用**：选择购买张数

**选项**：
- `1张` / `2张` / `3张` / `4张`

**注意**：
- 受平台限购规则限制
- 某些演出可能只能购买1-2张

---

### 3.2 高级配置

#### 实名购票人

**作用**：选择购票使用的实名信息

**使用场景**：
- 演出要求实名购票
- 需要选择特定的观演人

**配置方法**：
- 提前在大麦App中添加观演人信息
- 在GUI中选择第几个观演人

---

#### 智能备选

**作用**：当首选票档售罄时，自动选择备选

**选项**：
- ☑ 启用智能备选
- ☐ 不启用

**说明**：
- 开启后，如果首选票档没票，会自动选择其他有票的档位
- 适合"有票就行"的场景

---

## 🚀 第4章：功能选项

### 4.1 快速抢票模式（v2.2新功能）

**作用**：使用坐标点击，绕过UI检测，速度更快

**启用方法**：
1. 勾选 "启用快速抢票（v2.2坐标方案）"

2. 配置坐标：
   - 如果已有坐标文件（coordinates.json），会自动加载
   - 如果没有坐标，点击 "获取坐标" 按钮

**优势**：
- ⚡ 速度极快（绕过元素定位）
- 🎯 精准点击
- 💪 稳定性高

**适用场景**：
- 热门演出抢票
- 需要极致速度
- 已提前获取坐标

**注意事项**：
- 需要提前获取坐标
- 坐标与手机分辨率相关
- 不同演出可能需要不同坐标

### 4.2 坐标抢票

**作用**：使用预设坐标进行点击操作

**与快速抢票的区别**：
- 快速抢票：自动获取并使用坐标
- 坐标抢票：手动配置坐标方案

**使用方法**：
1. 勾选 "使用坐标抢票"
2. 选择坐标配置文件
3. 或手动配置坐标

### 4.3 优先购选项

**作用**：尝试选择优先购票档

**使用条件**：
- 演出有优先购票档
- 账号满足优先购条件

**注意**：
- 不是所有演出都有优先购
- 需要提前在大麦App中查看是否符合条件

### 4.4 自动提交订单

**作用**：抢到票后自动提交订单

**选项**：
- ☑ 自动提交
- ☐ 手动提交

**建议**：
- 如果确定购买：勾选自动提交
- 如果需要二次确认：不勾选

---

## 🎮 第5章：运行和控制

### 5.1 开始运行

**前置条件**：
- ✅ 设备已连接
- ✅ 配置已填写
- ✅ 大麦App已登录

**步骤**：

1. **最后检查**：
   - 确认关键词正确
   - 确认城市正确
   - 确认场次、票档选择

2. **点击"开始"按钮**

3. **观察运行**：
   - GUI日志区会显示详细进度
   - 可以在红手指界面看到App自动操作
   - 每个步骤都有日志记录

4. **运行流程**：
   ```
   [步骤1] 启动大麦App
   [步骤2] 进入搜索页面
   [步骤3] 输入关键词
   [步骤4] 点击搜索
   [步骤5] 选择搜索结果
   [步骤6] 进入详情页
   [步骤7] 选择场次
   [步骤8] 选择票档
   [步骤9] 确认购买
   [步骤10] 提交订单
   ```

5. **运行结束**：
   - 成功：日志显示 "订单提交成功" 或到达支付页面
   - 失败：日志显示错误信息和原因

### 5.2 监控运行

**日志说明**：

GUI会实时显示运行日志，颜色说明：
- **黑色**：普通信息（INFO）
- **绿色**：成功操作（SUCCESS）
- **黄色**：警告信息（WARNING）
- **红色**：错误信息（ERROR）

**关键日志示例**：

```
[INFO] [步骤1] 启动App...
[SUCCESS] ✓ App启动成功

[INFO] [步骤2] 进入搜索页面...
[SUCCESS] ✓ 已进入搜索页

[INFO] [步骤3] 输入关键词: 周杰伦
[SUCCESS] ✓ 关键词输入成功

[INFO] [步骤4] 点击搜索...
[SUCCESS] ✓ 搜索执行成功

...
```

**如何判断是否成功**：
- ✅ 每个步骤都有 "✓ 成功" 标记
- ✅ 最后显示 "订单提交成功"
- ✅ 在红手指界面看到支付页面

### 5.3 停止运行

**何时需要停止**：
- 运行出错想重新开始
- 发现配置错误
- 不想继续运行

**停止方法**：

1. 点击 "停止" 按钮

2. 等待当前操作完成

3. 日志显示 "已停止"

**注意**：
- 停止后需要重新点击 "开始"
- 已提交的订单无法撤销

### 5.4 重置

**作用**：重置所有设置到初始状态

**使用场景**：
- 想清空所有配置
- 准备开始新的演出

**操作**：
1. 点击 "重置" 按钮
2. 所有配置项清空
3. 需要重新填写

---

## 🔧 第6章：高级功能

### 6.1 屏幕实时监控

**作用**：实时查看云手机屏幕截图

**启用方法**：
1. 勾选 "启用屏幕监控"

2. 截图会保存在：
   ```
   根目录/screenshots/
   ```

3. 可以实时查看运行状态

### 6.2 坐标获取

**作用**：获取当前页面的关键元素坐标

**使用方法**：
1. 在红手指中打开大麦App
2. 进入要获取坐标的页面（如详情页）
3. 点击GUI中的 "获取坐标" 按钮
4. 坐标会保存到 coordinates.json

### 6.3 WebDriver检测

**作用**：测试WebDriver连接状态

**使用方法**：
1. 点击 "WebDriver检测" 按钮
2. 查看检测结果
3. 如果显示问题，使用急救箱修复

### 6.4 日志保存

**作用**：保存运行日志到文件

**位置**：
- GUI日志会自动保存
- 查看位置：项目根目录的日志文件

### 6.5 配置保存和加载

**保存配置**：
- 每次修改配置后会自动保存
- 保存位置：`last_config.json`

**加载配置**：
- 下次打开GUI会自动加载上次的配置
- 无需重新填写

---

## 📊 第7章：常见使用场景

### 场景1：普通抢票（最常用）

**适用**：一般热度的演出

**步骤**：
1. 连接设备
2. 填写关键词、城市
3. 选择场次、票档
4. 点击开始
5. 等待运行完成

**配置建议**：
- ☐ 快速抢票（不勾选）
- ☑ 智能备选（勾选）
- ☑ 自动提交（勾选）

---

### 场景2：热门抢票（速度优先）

**适用**：秒光的热门演出

**步骤**：
1. **提前准备**：
   - 提前获取坐标（点击"获取坐标"）
   - 确保网络稳定
   - 确保云手机性能良好

2. **配置**：
   - ☑ 启用快速抢票（勾选）
   - ☑ 智能备选（勾选）
   - ☑ 自动提交（勾选）

3. **开抢前**：
   - 提前5分钟连接设备
   - 提前2分钟启动程序，停留在详情页
   - 开抢时间点击 "开始"

**配置建议**：
- 购票数量：选择最少（1张）提高成功率
- 票档：选择稍低档位提高成功率

---

### 场景3：优先购抢票

**适用**：有优先购资格的演出

**步骤**：
1. **提前确认**：
   - 在大麦App中确认有优先购资格
   - 查看优先购时间

2. **配置**：
   - 关键词：填写演出名称
   - 城市：填写城市
   - 票档：选择 "优先购"
   - ☑ 优先购选项（勾选）

3. **运行**：
   - 在优先购开始时间点击 "开始"

---

### 场景4：测试运行

**适用**：测试配置是否正确

**步骤**：
1. 选择一个不重要的演出
2. 配置参数
3. ☐ 自动提交（不勾选，避免真的下单）
4. 点击开始
5. 观察运行流程
6. 到确认订单页面时点击"停止"

---

## ❓ 第8章：常见问题

### 问题1：运行到某一步就卡住了

**可能原因**：
- 页面加载慢
- 元素未找到
- 网络延迟

**解决方法**：
1. 等待更长时间
2. 检查云手机网络
3. 重启运行
4. 使用快速抢票模式

---

### 问题2：提示找不到元素

**症状**：
```
[ERROR] ✗ 未找到xxx元素
```

**原因**：
- 页面布局变化
- 大麦App更新
- 网络加载慢

**解决**：
1. 更新到最新版本项目
2. 使用快速抢票（坐标方案）
3. 等待页面完全加载

---

### 问题3：订单提交失败

**可能原因**：
- 票已售罄
- 实名信息未填写
- 地址未选择
- 超过购买限制

**解决**：
1. 检查大麦App中的账号信息是否完整
2. 确保有可用的收货地址
3. 确保观演人信息已添加

---

### 问题4：运行速度太慢

**症状**：每个步骤间隔很长

**原因**：
- 未使用快速抢票
- 云手机性能不足
- 网络延迟

**优化**：
1. ☑ 启用快速抢票
2. 升级云手机配置（更高内存）
3. 检查网络连接

---

## 💡 第9章：使用技巧

### 技巧1：提前演练

**建议**：
- 在正式抢票前，用不重要的演出测试流程
- 熟悉每个步骤的时间
- 确保配置正确

### 技巧2：多账号准备

**方法**：
- 准备多个大麦账号
- 使用多个云手机
- 提高成功率

### 技巧3：时间把控

**建议**：
- 提前5分钟打开GUI并连接设备
- 提前2分钟运行到详情页
- 开抢瞬间点击 "开始"

### 技巧4：备选方案

**准备**：
- 勾选 "智能备选"
- 准备多个票档选择
- 不要只盯着最贵的票

### 技巧5：网络优化

**建议**：
- 使用稳定的网络（避免WiFi）
- 关闭其他占用带宽的程序
- 红手指选择网络好的节点

---

## 📞 第10章：获取帮助

### 查看文档

1. **完整文档索引**：docs/README.md
2. **安装教程**：docs/guides/完整安装教程_小白版.md
3. **常见问题**：docs/FAQ.md

### 问题反馈

1. **GitHub Issues**：提交问题到项目Issues页面
2. **提供信息**：
   - 运行日志
   - 错误截图
   - 配置信息

---

## ⚠️ 重要提醒

### 合法使用

- ✅ 本项目仅用于技术学习
- ❌ 严禁用于商业倒票
- ❌ 严禁破坏平台秩序

### 责任声明

- 使用本项目即表示同意法律声明
- 所有操作后果由使用者承担
- 与项目开发者无关

---

**教程版本**: v1.0
**最后更新**: 2025-11-17
**适用项目版本**: v2.2

---

**祝您使用愉快！Remember: Learn responsibly, use ethically! 🚀**
