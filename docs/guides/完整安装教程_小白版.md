# 📖 完整安装教程（小白版）

> **适用人群**：完全没有编程基础的新手
> **操作系统**：Windows 10/11
> **预计时间**：30-60分钟

---

## 📋 教程说明

本教程将**手把手**教您安装和配置整个项目，每一步都有详细说明。

**即使您从未接触过编程，也能顺利完成！**

---

## 🎯 安装概览

我们需要安装以下软件（不用担心，每一步都有详细说明）：

1. ✅ **Python** - 编程语言（运行项目必需）
2. ✅ **Android SDK** - Android开发工具（连接手机必需）
3. ✅ **Node.js** - JavaScript运行环境（运行Appium必需）
4. ✅ **Appium** - 移动端自动化工具（核心工具）
5. ✅ **本项目** - 下载和配置

**不要被这么多软件吓到！每个都很简单，跟着做就行！**

---

## 第1章：安装Python

### 1.1 下载Python

1. 打开浏览器，访问Python官网：
   ```
   https://www.python.org/downloads/
   ```

2. 点击页面上的黄色大按钮 **"Download Python 3.x.x"**
   - 注意：版本号可能不同，只要是3.8以上都可以

3. 下载完成后，你会得到一个文件，名字类似：
   ```
   python-3.11.5-amd64.exe
   ```

### 1.2 安装Python

**重要提示**：这一步有个关键操作，千万别漏！

1. **双击**下载的安装文件

2. **【关键步骤】** 在安装界面的**最下方**，勾选：
   ```
   ☑ Add Python to PATH
   ```
   **这一步非常重要！一定要勾选！**

3. 点击 **"Install Now"**（现在安装）

4. 等待安装完成（大约1-2分钟）

5. 看到 "Setup was successful" （安装成功）即完成

### 1.3 验证Python安装

验证是否安装成功：

1. 按键盘上的 `Win + R` 键（Win键就是有Windows图标那个键）

2. 在弹出的窗口中输入：
   ```
   cmd
   ```

3. 按回车，会打开一个黑色窗口（命令提示符）

4. 在黑色窗口中输入：
   ```
   python --version
   ```

5. 按回车，如果显示类似这样的内容，就说明成功了：
   ```
   Python 3.11.5
   ```

**如果显示"不是内部或外部命令"**，说明第1.2步的勾选没做好，需要重新安装Python并勾选"Add Python to PATH"。

---

## 第2章：安装Android SDK

### 2.1 为什么需要Android SDK？

SDK全称是"Software Development Kit"（软件开发工具包）。

我们需要它来：
- 连接Android手机或云手机
- 使用ADB工具进行调试

### 2.2 选择安装方式

有两种方式，推荐**方式1（简单）**：

#### 方式1：通过Android Studio安装（推荐新手）

**1. 下载Android Studio**

访问官网：
```
https://developer.android.com/studio
```

点击 **"Download Android Studio"** 下载

**2. 安装Android Studio**

- 双击下载的安装文件
- 一路点击 "Next"（下一步）
- 等待安装完成（可能需要10-20分钟，因为文件较大）

**3. 首次启动配置**

- 启动Android Studio
- 选择 "Standard" （标准安装）
- 等待下载SDK组件（需要联网，可能需要15-30分钟）

**4. 安装完成**

安装完成后，SDK会在这个位置：
```
C:\Users\你的用户名\AppData\Local\Android\Sdk
```

#### 方式2：仅安装命令行工具（适合有经验用户）

1. 访问：https://developer.android.com/studio#command-tools
2. 下载 "Command line tools only"
3. 解压到指定目录
4. 配置环境变量

**新手建议用方式1！**

### 2.3 配置环境变量

这一步是让系统知道SDK在哪里。

**步骤**：

1. **打开环境变量设置**
   - 右键点击 "此电脑"（或"我的电脑"）
   - 选择 "属性"
   - 点击左侧 "高级系统设置"
   - 点击 "环境变量"

2. **添加ANDROID_HOME**
   - 在 "系统变量" 区域，点击 "新建"
   - 变量名输入：
     ```
     ANDROID_HOME
     ```
   - 变量值输入SDK路径（根据你的实际路径）：
     ```
     C:\Users\你的用户名\AppData\Local\Android\Sdk
     ```
   - 点击 "确定"

3. **添加到PATH**
   - 找到系统变量中的 "Path"
   - 点击 "编辑"
   - 点击 "新建"
   - 添加以下两个路径：
     ```
     %ANDROID_HOME%\platform-tools
     %ANDROID_HOME%\tools
     ```
   - 点击 "确定"

### 2.4 验证Android SDK安装

1. **重新打开**命令提示符（之前打开的要关掉重开）

2. 输入命令：
   ```
   adb version
   ```

3. 如果显示版本信息，就说明安装成功了：
   ```
   Android Debug Bridge version 1.0.41
   ```

---

## 第3章：安装Node.js

### 3.1 下载Node.js

1. 访问Node.js官网：
   ```
   https://nodejs.org/
   ```

2. 下载 **LTS版本**（左边那个，推荐版本）
   - 注意：一定要下载LTS，不要下载Current

3. 下载完成后得到类似这样的文件：
   ```
   node-v20.11.0-x64.msi
   ```

### 3.2 安装Node.js

1. **双击**安装文件

2. 点击 "Next"（下一步）

3. 勾选 "I accept..."（我接受协议）

4. 一直点击 "Next"，使用默认设置即可

5. 点击 "Install"（安装）

6. 等待安装完成

7. 点击 "Finish"（完成）

### 3.3 验证Node.js安装

1. 打开命令提示符（Win + R，输入cmd）

2. 输入命令：
   ```
   node --version
   ```

3. 应该显示类似：
   ```
   v20.11.0
   ```

4. 再输入命令：
   ```
   npm --version
   ```

5. 应该显示类似：
   ```
   10.2.4
   ```

**两个都有版本号就说明安装成功！**

---

## 第4章：安装Appium

### 4.1 什么是Appium？

Appium是一个移动端自动化测试工具，本项目的核心依赖。

### 4.2 安装Appium Server

1. 打开命令提示符（Win + R，输入cmd）

2. 输入命令：
   ```
   npm install -g appium
   ```

3. 按回车，等待安装（可能需要5-10分钟）
   - 会看到很多文字滚动，这是正常的
   - 耐心等待，直到回到命令行提示符

4. 安装UiAutomator2驱动（必需）：
   ```
   appium driver install uiautomator2
   ```

### 4.3 验证Appium安装

1. 输入命令：
   ```
   appium --version
   ```

2. 如果显示版本号（如 2.5.4），说明安装成功！

### 4.4 安装Appium Inspector（可选，但推荐）

Appium Inspector是一个图形化界面工具，方便调试。

1. 访问GitHub Release页面：
   ```
   https://github.com/appium/appium-inspector/releases
   ```

2. 下载最新版本的Windows安装包：
   ```
   Appium-Inspector-windows-xxxx.exe
   ```

3. 双击安装，一路Next即可

---

## 第5章：下载和配置本项目

### 5.1 下载项目

**方式1：直接下载ZIP（推荐新手）**

1. 访问项目GitHub页面（或下载页面）

2. 点击绿色的 **"Code"** 按钮

3. 点击 **"Download ZIP"**

4. 下载完成后，**解压**到一个你记得住的位置，比如：
   ```
   D:\Projects\mobile-automation-demo
   ```

**方式2：使用Git克隆（适合有Git基础的）**

```bash
git clone https://github.com/你的用户名/mobile-automation-demo.git
```

### 5.2 安装项目依赖

1. 打开命令提示符

2. **切换到项目目录**：
   ```
   cd D:\Projects\mobile-automation-demo
   ```
   （替换成你实际解压的路径）

3. **安装Python依赖**：
   ```
   pip install -r requirements.txt
   ```

4. 等待安装完成（可能需要5-10分钟）
   - 会看到很多"Successfully installed xxx"
   - 这是正常的，说明在安装依赖包

**如果安装失败**，可以尝试使用国内镜像：
```
pip install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple
```

### 5.3 配置项目

1. **找到配置模板文件**：
   ```
   damai_appium/config.jsonc.example
   ```

2. **复制并重命名**：
   - 复制这个文件
   - 重命名为：
     ```
     config.jsonc
     ```
   - 最终路径应该是：
     ```
     damai_appium/config.jsonc
     ```

3. **编辑配置文件**：
   - 右键点击 `config.jsonc`
   - 选择 "打开方式" → "记事本"
   - 修改以下内容：

```jsonc
{
  // ADB端口（稍后从红手指获取）
  "adb_port": "62001",  // 改成你的红手指端口

  // 关键词（要搜索的演出）
  "keyword": "周杰伦",  // 改成你要搜索的演出名称

  // 城市
  "city": "北京",  // 改成你所在的城市

  // 其他配置暂时保持默认即可
}
```

4. 保存文件

---

## 第6章：配置红手指云手机

### 6.1 注册红手指账号

1. 访问红手指官网：
   ```
   https://www.xiaohongshou.com/
   ```

2. 点击 "注册" 创建账号

3. 完成实名认证（需要身份证）

### 6.2 创建云手机

1. 登录红手指客户端

2. 点击 "+" 创建云手机

3. 选择配置：
   - **系统版本**：Android 7.0 或以上
   - **内存**: 2GB或以上（推荐）
   - **时长**: 根据需要选择

4. 点击 "创建" 并等待

5. 云手机创建完成后，会显示在列表中

### 6.3 启动云手机并开启ADB调试

1. **启动云手机**：
   - 点击云手机卡片的 "启动" 按钮
   - 等待云手机启动（显示为"在线"状态，绿色图标）

2. **查看ADB端口**：
   - 在云手机卡片上，找到 "ADB端口" 或 "端口号"
   - 记下这个端口号，比如：`62001`
   - **这个端口号非常重要，稍后要用！**

3. **在云手机中开启ADB调试**：
   - 点击云手机卡片，进入云手机界面
   - 在云手机中打开 "设置"
   - 找到 "关于手机" 或 "关于平板"
   - 连续点击 "版本号" 7次，开启开发者模式
   - 返回设置，找到 "开发者选项"
   - 开启 "USB调试"

4. **安装大麦App**：
   - 在云手机中打开应用商店
   - 搜索 "大麦"
   - 下载并安装大麦App
   - 登录你的大麦账号

### 6.4 测试ADB连接

回到你的电脑上：

1. 打开命令提示符

2. 输入命令连接云手机：
   ```
   adb connect 127.0.0.1:62001
   ```
   （把62001换成你实际的端口号）

3. 如果显示：
   ```
   connected to 127.0.0.1:62001
   ```
   说明连接成功！

4. 输入命令查看设备：
   ```
   adb devices
   ```

5. 应该看到：
   ```
   List of devices attached
   127.0.0.1:62001    device
   ```

**如果显示 "offline" 或 "unauthorized"**，说明云手机没开启USB调试，回到第6.3步重新操作。

---

## 第7章：运行项目

### 7.1 启动Appium Server

**方式1：使用启动脚本（推荐）**

1. 找到项目中的 `scripts/start_appium.bat` 文件

2. **双击**这个文件

3. 会弹出一个黑色窗口，显示Appium启动日志

4. 看到类似这样的内容，说明启动成功：
   ```
   [Appium] Appium REST http interface listener started on 127.0.0.1:4723
   ```

5. **保持这个窗口打开**，不要关闭！

**方式2：手动启动**

打开命令提示符，输入：
```
appium --address 127.0.0.1 --port 4723 --allow-cors
```

### 7.2 启动GUI程序

1. 找到项目根目录的 `damai_smart_ai.py` 文件

2. **双击**这个文件

   **如果双击没反应**，试试这样：
   - 右键点击文件
   - 选择 "打开方式" → "Python"

   **如果还是不行**，用命令行：
   - 打开命令提示符
   - 切换到项目目录
   - 输入命令：
     ```
     python damai_smart_ai.py
     ```

3. 稍等几秒，会弹出GUI界面

### 7.3 连接设备

在GUI界面中：

1. **填写ADB端口**：
   - 在 "ADB端口" 输入框中
   - 输入你的红手指端口号（比如 62001）

2. **点击 "连接设备" 按钮**

3. **查看日志**：
   - 在下方的日志区域
   - 应该看到连接进度日志
   - 最终显示 "连接成功" 或类似信息

**如果连接失败**：
- 点击 "🏥 连接急救箱" 按钮
- 它会自动诊断问题并尝试修复

### 7.4 运行测试

1. **配置演出信息**：
   - 在GUI中填写关键词（如 "周杰伦"）
   - 填写城市（如 "北京"）
   - 选择其他选项（场次、票档等）

2. **开始测试**：
   - 点击 "开始" 按钮
   - 程序会自动运行

3. **监控运行**：
   - 观察日志输出
   - 可以在云手机界面中看到App在自动操作

4. **停止测试**：
   - 如果需要停止，点击 "停止" 按钮

---

## 🔧 常见问题

### 问题1：Python安装后，cmd中提示"不是内部或外部命令"

**原因**：安装时没有勾选 "Add Python to PATH"

**解决方法**：
1. 卸载Python
2. 重新安装，一定要勾选 "Add Python to PATH"

---

### 问题2：pip install安装依赖时速度很慢或失败

**解决方法**：使用国内镜像源

```bash
pip install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple
```

---

### 问题3：adb devices显示设备为offline

**原因**：云手机未开启USB调试，或红手指未启动

**解决方法**：
1. 确保红手指云手机状态为 "在线"（绿色）
2. 在云手机中检查 "开发者选项" → "USB调试" 是否开启
3. 重新连接：
   ```
   adb disconnect 127.0.0.1:端口号
   adb connect 127.0.0.1:端口号
   ```

---

### 问题4：GUI点击连接设备后没反应

**解决方法**：
1. 检查Appium是否启动（应该有黑色窗口在运行）
2. 检查ADB端口号是否正确
3. 点击 "🏥 连接急救箱" 进行诊断

---

### 问题5：运行时提示缺少某个模块

**症状**：
```
ModuleNotFoundError: No module named 'xxx'
```

**解决方法**：
```bash
pip install xxx
```
（把xxx换成提示缺少的模块名）

或者重新安装依赖：
```bash
pip install -r requirements.txt
```

---

## ✅ 安装完成检查清单

安装完成后，请确认以下所有项目都打勾：

- [ ] Python已安装，`python --version` 有版本号
- [ ] Android SDK已安装，`adb version` 有版本号
- [ ] Node.js已安装，`node --version` 有版本号
- [ ] Appium已安装，`appium --version` 有版本号
- [ ] 项目已下载并解压
- [ ] 项目依赖已安装（pip install成功）
- [ ] 配置文件已创建（config.jsonc）
- [ ] 红手指云手机已创建并启动
- [ ] ADB调试已开启
- [ ] ADB可以连接云手机（adb devices显示device）
- [ ] Appium Server可以启动
- [ ] GUI程序可以打开
- [ ] GUI可以连接到设备

**如果以上全部打勾，恭喜您安装成功！** 🎉

---

## 📞 获取帮助

如果遇到本教程无法解决的问题：

1. **查看完整文档**：docs/README.md
2. **查看常见问题**：docs/FAQ.md
3. **GitHub Issues**：提交问题到项目Issues页面

---

**教程版本**: v1.0
**最后更新**: 2025-11-17
**适用项目版本**: v2.2

---

**祝您使用愉快！Have fun learning automation! 🚀**
