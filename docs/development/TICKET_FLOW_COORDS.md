# 大麦抢票完整流程 - 坐标点击方案

## 流程概述
从首页到成功抢票的完整自动化流程

---

## 详细步骤

### 步骤1: 启动大麦App并等待首页加载
**操作**: 启动App，等待进入首页
**验证**: 确认首页页面元素显示

---

### 步骤2: 切换城市
**操作**: 点击城市选择入口
- **坐标**: `216, 88`
- **目标页面**: 城市选择页面

**输入城市关键词**:
- **操作**: 输入城市名称（例如：南京）
- **输入框**: 搜索框

**选择城市**:
- **坐标**: `99, 328`
- **结果**: 成功切换到选定城市，返回首页（已更新城市）

---

### 步骤3: 搜索演出
**操作**: 点击搜索入口
- **坐标**: `315, 97`

**输入搜索关键词**:
- **操作**: 输入演出关键词（例如：2025黎明巡回演唱会）

**进入搜索结果**:
- **坐标**: `155, 195`
- **目标页面**: 演出列表页

---

### 步骤4: 选择演出
**操作**: 点击目标演出
- **坐标**: `337, 329`
- **目标页面**: 演出详情页

---

### 步骤5: 立即购票
**操作**: 点击立即购票按钮
- **坐标**: `464, 1227`
- **目标页面**: 场次/票档选择页面

---

### 步骤6: 选择场次和票档
**注意**: 不同演出的场次/票档页面布局可能不同，坐标仅供参考

**选择场次**:
- **坐标**: `209, 435`
- **说明**: 点击场次选项

**选择票档**:
- **坐标**: `169, 659`
- **说明**: 点击票档/价格选项

**确认选择**:
- **坐标**: `558, 1233`
- **说明**: 点击确定按钮

---

### 步骤7: 处理排队提示
**场景**: 遇到"抱歉，当前排队的人数太多了"提示
**操作**: 疯狂重试
- **坐标**: `376, 907`
- **策略**: 快速连续点击，直到成功进入下一步

---

## 坐标速查表

| 步骤 | 操作 | X坐标 | Y坐标 | 说明 |
|------|------|-------|-------|------|
| 2 | 城市选择入口 | 216 | 88 | 打开城市选择 |
| 2 | 选择城市 | 99 | 328 | 点击城市项 |
| 3 | 搜索入口 | 315 | 97 | 打开搜索 |
| 3 | 搜索结果 | 155 | 195 | 进入列表页 |
| 4 | 选择演出 | 337 | 329 | 进入详情页 |
| 5 | 立即购票 | 464 | 1227 | 进入场次页 |
| 6 | 选择场次 | 209 | 435 | 点击场次 |
| 6 | 选择票档 | 169 | 659 | 点击票档 |
| 6 | 确定选择 | 558 | 1233 | 确认 |
| 7 | 重试按钮 | 376 | 907 | 排队重试 |

---

## 注意事项

1. **坐标适配**: 这些坐标基于特定设备分辨率，不同设备可能需要调整
2. **等待时间**: 每步操作后需要适当等待，确保页面加载完成
3. **异常处理**:
   - 城市切换失败 → 重试
   - 搜索无结果 → 检查关键词
   - 场次票档页面布局变化 → 需要重新定位坐标
   - 排队人数过多 → 持续重试

4. **动态元素**: 场次/票档页面布局因演出而异，建议：
   - 提前测试目标演出的页面布局
   - 记录实际坐标
   - 准备多个备选坐标点

---

## 实现建议

### 配置化坐标
```json
{
  "coords": {
    "city_selector": [216, 88],
    "city_item": [99, 328],
    "search_entry": [315, 97],
    "search_result": [155, 195],
    "show_item": [337, 329],
    "buy_button": [464, 1227],
    "session_selector": [209, 435],
    "price_selector": [169, 659],
    "confirm_button": [558, 1233],
    "retry_button": [376, 907]
  }
}
```

### 流程控制
```python
def auto_ticket_flow(city, keyword, session_index=0, price_index=0):
    """完整抢票流程"""
    # 1. 等待首页
    wait_for_homepage()

    # 2. 切换城市
    switch_city(city)

    # 3. 搜索演出
    search_show(keyword)

    # 4. 选择演出
    select_show(index=0)  # 默认第一个

    # 5. 立即购票
    click_buy_button()

    # 6. 选择场次和票档
    select_session_and_price(session_index, price_index)

    # 7. 处理排队
    handle_queue_retry()
```

---

## 测试建议

1. **单步测试**: 逐步验证每个坐标点击是否准确
2. **完整流程**: 测试从首页到购票的完整流程
3. **异常场景**: 测试网络延迟、页面加载慢等情况
4. **不同演出**: 验证场次/票档页面的坐标差异

---

生成时间: 2025-11-15
设备分辨率: 待确认（根据实际设备调整坐标）
