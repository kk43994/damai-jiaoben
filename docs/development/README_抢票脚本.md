# å¤§éº¦æŠ¢ç¥¨ç³»ç»Ÿ - å®Œæ•´æ–‡æ¡£

## ðŸ“š æ–‡æ¡£ç´¢å¼•

### æ ¸å¿ƒæ–‡æ¡£
- **[USAGE_GUIDE.md](USAGE_GUIDE.md)** - è¯¦ç»†ä½¿ç”¨æŒ‡å— â­ å¿…è¯»
- **[TICKET_FLOW_COORDS.md](TICKET_FLOW_COORDS.md)** - å®Œæ•´æµç¨‹å’Œåæ ‡è¯´æ˜Ž
- **[é›†æˆæŒ‡å—.md](é›†æˆæŒ‡å—.md)** - GUIé›†æˆæ•™ç¨‹
- **[å®Œå–„æ€»ç»“.md](å®Œå–„æ€»ç»“.md)** - ä»Šæ—¥å·¥ä½œæ€»ç»“

### æ ¸å¿ƒè„šæœ¬
- **[damai_ticket_bot.py](damai_ticket_bot.py)** - ç”Ÿäº§çº§æŠ¢ç¥¨è„šæœ¬ (550è¡Œ)
- **[test_ticket_flow.py](test_ticket_flow.py)** - æµ‹è¯•è„šæœ¬ (340è¡Œ)
- **[damai_gui.py](damai_gui.py)** - ç‹¬ç«‹GUIç•Œé¢

---

## ðŸš€ å¿«é€Ÿå¼€å§‹

### 1. æœ€ç®€å•çš„ä½¿ç”¨æ–¹å¼

```bash
# 1. é…ç½®å‚æ•° (ç¼–è¾‘ damai_appium/config.jsonc)
{
  "adb_port": "62616",
  "city": "å—äº¬",
  "keyword": "2025é»Žæ˜Žå·¡å›žæ¼”å”±ä¼š"
}

# 2. è¿è¡Œè„šæœ¬
python damai_ticket_bot.py
```

### 2. å‘½ä»¤è¡Œä½¿ç”¨

```bash
# åŸºç¡€ä½¿ç”¨
python damai_ticket_bot.py --city åŒ—äº¬ --keyword "å¼ å­¦å‹æ¼”å”±ä¼š"

# å¯ç”¨æŽ’é˜Ÿé‡è¯•
python damai_ticket_bot.py --queue-retry --max-queue-retries 300
```

### 3. GUIä½¿ç”¨

```bash
python damai_gui.py
```

---

## ðŸ“¦ æ–‡ä»¶è¯´æ˜Ž

### ä¸»è¦è„šæœ¬

| æ–‡ä»¶ | è¡Œæ•° | è¯´æ˜Ž | æŽ¨èåœºæ™¯ |
|------|------|------|---------|
| `damai_ticket_bot.py` | 550+ | ç”Ÿäº§çº§æŠ¢ç¥¨è„šæœ¬ | æ­£å¼æŠ¢ç¥¨ â­ |
| `test_ticket_flow.py` | 340 | æµç¨‹æµ‹è¯•è„šæœ¬ | è°ƒè¯•åæ ‡ |
| `damai_gui.py` | 400+ | ç‹¬ç«‹GUIç‰ˆæœ¬ | å›¾å½¢åŒ–æ“ä½œ |
| `input_chinese.py` | 30 | ä¸­æ–‡è¾“å…¥æµ‹è¯• | æµ‹è¯•è¾“å…¥ |
| `damai_smart_ai.py` | 4285 | OCRæ™ºèƒ½ç›‘æŽ§ (åŽŸæœ‰) | OCRç›‘æŽ§ |

### æ–‡æ¡£æ–‡ä»¶

| æ–‡ä»¶ | è¯´æ˜Ž |
|------|------|
| `USAGE_GUIDE.md` | è¯¦ç»†ä½¿ç”¨æŒ‡å—,æ•…éšœæŽ’æŸ¥ |
| `TICKET_FLOW_COORDS.md` | å®Œæ•´7æ­¥æµç¨‹è¯´æ˜Ž |
| `é›†æˆæŒ‡å—.md` | GUIé›†æˆæ•™ç¨‹ |
| `å®Œå–„æ€»ç»“.md` | ä»Šæ—¥å·¥ä½œæ€»ç»“ |
| `README_æŠ¢ç¥¨è„šæœ¬.md` | æœ¬æ–‡ä»¶ |

### é…ç½®æ–‡ä»¶

| æ–‡ä»¶ | è¯´æ˜Ž |
|------|------|
| `damai_appium/config.jsonc` | ä¸»é…ç½®æ–‡ä»¶ |
| `last_config.json` | ä¸Šæ¬¡é…ç½®è®°å½• |

---

## ðŸŽ¯ æ ¸å¿ƒåŠŸèƒ½

### damai_ticket_bot.py ç‰¹æ€§

âœ… **å®Œæ•´æŠ¢ç¥¨æµç¨‹** (7æ­¥)
1. ç­‰å¾…é¦–é¡µåŠ è½½
2. åˆ‡æ¢åŸŽå¸‚ (å«æœç´¢æ¡†æ¿€æ´»)
3. æœç´¢æ¼”å‡º
4. é€‰æ‹©æ¼”å‡º
5. ç«‹å³è´­ç¥¨
6. é€‰æ‹©åœºæ¬¡/ç¥¨æ¡£
7. æŽ’é˜Ÿé‡è¯• (å¯é€‰)

âœ… **å¥å£®æ€§å¢žå¼º**
- è‡ªåŠ¨é‡è¯•å¤±è´¥æ“ä½œ (é»˜è®¤3æ¬¡)
- é¡µé¢çŠ¶æ€éªŒè¯
- WebDriverå¼‚å¸¸å¤„ç†
- è¶…æ—¶ä¿æŠ¤æœºåˆ¶

âœ… **ä¸­æ–‡æ”¯æŒ**
- ä½¿ç”¨Appiumçš„`send_keys()`æ–¹æ³•
- å®Œç¾Žæ”¯æŒä¸­æ–‡åŸŽå¸‚å’Œå…³é”®è¯

âœ… **è¯¦ç»†æ—¥å¿—**
- Emojiæ ‡è¯†ä¸åŒçº§åˆ«: â„¹ï¸ âœ… âŒ âš ï¸ ðŸ“ ðŸ”„ ðŸ”
- æ—¶é—´æˆ³è®°å½•
- è¿›åº¦è·Ÿè¸ª

âœ… **çµæ´»é…ç½®**
- JSONé…ç½®æ–‡ä»¶
- å‘½ä»¤è¡Œå‚æ•°è¦†ç›–
- è¿è¡Œæ—¶å¯è°ƒæ•´

---

## ðŸ’¡ ä½¿ç”¨ç¤ºä¾‹

### ç¤ºä¾‹1: åŸºç¡€æŠ¢ç¥¨

```bash
python damai_ticket_bot.py \
    --city å—äº¬ \
    --keyword "2025é»Žæ˜Žå·¡å›žæ¼”å”±ä¼š"
```

### ç¤ºä¾‹2: å¯ç”¨æŽ’é˜Ÿé‡è¯•

```bash
python damai_ticket_bot.py \
    --city åŒ—äº¬ \
    --keyword "å¼ å­¦å‹æ¼”å”±ä¼š" \
    --queue-retry \
    --max-queue-retries 500
```

### ç¤ºä¾‹3: ä½¿ç”¨é…ç½®æ–‡ä»¶

```bash
# 1. ç¼–è¾‘é…ç½®æ–‡ä»¶
cat > damai_appium/config.jsonc << EOF
{
  "adb_port": "62616",
  "city": "ä¸Šæµ·",
  "keyword": "å‘¨æ°ä¼¦æ¼”å”±ä¼š"
}
EOF

# 2. ç›´æŽ¥è¿è¡Œ
python damai_ticket_bot.py
```

### ç¤ºä¾‹4: Pythonä»£ç è°ƒç”¨

```python
from damai_ticket_bot import DamaiTicketBot

# åˆ›å»ºå®žä¾‹
bot = DamaiTicketBot()

# é…ç½®å‚æ•°
bot.config['city'] = 'åŒ—äº¬'
bot.config['keyword'] = 'æ¼”å”±ä¼š'
bot.config['adb_port'] = '62616'

# è¿è¡Œ
success = bot.run(enable_queue_retry=True)
```

---

## âš ï¸ é‡è¦æç¤º

### 1. åŸŽå¸‚é€‰æ‹©æ˜¯4æ­¥,ä¸æ˜¯3æ­¥!

```
æ­¥éª¤1: ç‚¹å‡»åŸŽå¸‚é€‰æ‹©å…¥å£ (216, 88)
æ­¥éª¤2: ç‚¹å‡»æœç´¢æ¡†æ¿€æ´» (148, 192) â† å®¹æ˜“é—æ¼!
æ­¥éª¤3: è¾“å…¥åŸŽå¸‚åç§°
æ­¥éª¤4: ç‚¹å‡»åŸŽå¸‚é€‰é¡¹ (99, 328)
```

### 2. ä¸­æ–‡è¾“å…¥å¿…é¡»ç”¨Appium

```python
# âœ… æ­£ç¡®
active = driver.switch_to.active_element
active.send_keys("å—äº¬")

# âŒ é”™è¯¯ (ä¸æ”¯æŒä¸­æ–‡)
adb shell input text "nanjing"
```

### 3. åœºæ¬¡/ç¥¨æ¡£åæ ‡å› æ¼”å‡ºè€Œå¼‚

å½“å‰è„šæœ¬ä¸­çš„åæ ‡æ˜¯**ç¤ºä¾‹åæ ‡**,ä¸åŒæ¼”å‡ºå¯èƒ½ä¸åŒã€‚

**ä½¿ç”¨å‰å¿…é¡»åš:**
1. æ‰‹åŠ¨è¿›å…¥ç›®æ ‡æ¼”å‡ºçš„åœºæ¬¡é¡µé¢
2. æµ‹è¯•åæ ‡æ˜¯å¦å‡†ç¡®:
   ```bash
   adb shell input tap 209 435  # åœºæ¬¡
   adb shell input tap 169 659  # ç¥¨æ¡£
   adb shell input tap 558 1233 # ç¡®è®¤
   ```
3. å¦‚ä¸å‡†ç¡®,ä¿®æ”¹`damai_ticket_bot.py`ä¸­çš„åæ ‡

### 4. æ»‘å—éªŒè¯éœ€è¦æ‰‹åŠ¨å¤„ç†

ç‚¹å‡»"ç«‹å³è´­ç¥¨"åŽå¯èƒ½å‡ºçŽ°æ»‘å—éªŒè¯,å½“å‰éœ€è¦äººå·¥å®Œæˆã€‚

---

## ðŸ”§ çŽ¯å¢ƒè¦æ±‚

### å¿…éœ€è½¯ä»¶

- Python 3.7+
- Appium Server (http://127.0.0.1:4723)
- ADB (Android Debug Bridge)
- Androidæ¨¡æ‹Ÿå™¨æˆ–çœŸæœº

### Pythonä¾èµ–

```bash
pip install appium-python-client selenium
```

### æ£€æŸ¥çŽ¯å¢ƒ

```bash
# 1. AppiumæœåŠ¡
curl http://127.0.0.1:4723/status

# 2. ADBè¿žæŽ¥
adb devices

# 3. Pythonä¾èµ–
python -c "from appium import webdriver; print('OK')"
```

---

## ðŸ“– è¯¦ç»†æ–‡æ¡£

### æ–°æ‰‹å¿…è¯»

1. **[USAGE_GUIDE.md](USAGE_GUIDE.md)** - ä»Žé›¶å¼€å§‹çš„å®Œæ•´æŒ‡å—
   - å¿«é€Ÿå¼€å§‹
   - å‘½ä»¤è¡Œå‚æ•°è¯´æ˜Ž
   - é‡è¦æ³¨æ„äº‹é¡¹
   - æ•…éšœæŽ’æŸ¥
   - æœ€ä½³å®žè·µ

### è¿›é˜¶ä½¿ç”¨

2. **[TICKET_FLOW_COORDS.md](TICKET_FLOW_COORDS.md)** - æµç¨‹ç»†èŠ‚
   - å®Œæ•´7æ­¥æµç¨‹è¯´æ˜Ž
   - æ‰€æœ‰åæ ‡é€ŸæŸ¥è¡¨
   - åæ ‡é…ç½®å»ºè®®

### é›†æˆå¼€å‘

3. **[é›†æˆæŒ‡å—.md](é›†æˆæŒ‡å—.md)** - GUIé›†æˆ
   - é›†æˆæ–¹æ¡ˆè¯´æ˜Ž
   - å®Œæ•´ä»£ç ç¤ºä¾‹
   - çº¿ç¨‹å®‰å…¨å¤„ç†

---

## ðŸŽ“ å…³é”®å­¦ä¹ ç‚¹

ä»Šå¤©é€šè¿‡æ‰‹åŠ¨æ•™å­¦å‘çŽ°çš„é‡ç‚¹:

### 1. åŸŽå¸‚é€‰æ‹©æµç¨‹

**ä¹‹å‰è®¤ä¸º**: 3æ­¥ (ç‚¹å…¥å£ â†’ è¾“å…¥ â†’ é€‰æ‹©)
**å®žé™…æ˜¯**: 4æ­¥ (ç‚¹å…¥å£ â†’ **æ¿€æ´»æœç´¢æ¡†** â†’ è¾“å…¥ â†’ é€‰æ‹©)

**å…³é”®**: å¿…é¡»å…ˆç‚¹å‡»(148, 192)æ¿€æ´»æœç´¢æ¡†,å¦åˆ™æ— æ³•è¾“å…¥!

### 2. ä¸­æ–‡è¾“å…¥æ–¹æ¡ˆ

**ADBæ–¹å¼**: âŒ ä¸æ”¯æŒä¸­æ–‡
```bash
adb shell input text "nanjing"  # åªèƒ½è¾“è‹±æ–‡
```

**Appiumæ–¹å¼**: âœ… å®Œç¾Žæ”¯æŒä¸­æ–‡
```python
active = driver.switch_to.active_element
active.send_keys("å—äº¬")  # æ”¯æŒä¸­æ–‡
```

### 3. åæ ‡åŠ¨æ€æ€§

**å›ºå®šåæ ‡**: åŸŽå¸‚é€‰æ‹©ã€æœç´¢ã€æ¼”å‡ºé€‰æ‹©ç­‰é¡µé¢
**åŠ¨æ€åæ ‡**: åœºæ¬¡/ç¥¨æ¡£é€‰æ‹©é¡µé¢ (å› æ¼”å‡ºè€Œå¼‚)

**å»ºè®®**: ä¸ºæ¯ä¸ªç›®æ ‡æ¼”å‡ºå•ç‹¬è®°å½•åœºæ¬¡/ç¥¨æ¡£åæ ‡

---

## ðŸ“Š è„šæœ¬å¯¹æ¯”

| ç‰¹æ€§ | test_ticket_flow.py | damai_ticket_bot.py | damai_gui.py |
|------|---------------------|---------------------|--------------|
| ç”¨é€” | æµ‹è¯•è°ƒè¯• | ç”Ÿäº§ä½¿ç”¨ | GUIæ“ä½œ |
| ä»£ç è¡Œæ•° | 340 | 550+ | 400+ |
| é”™è¯¯å¤„ç† | åŸºç¡€ | å®Œå–„ | å®Œå–„ |
| é‡è¯•æœºåˆ¶ | æ—  | æœ‰ (3æ¬¡) | æœ‰ |
| æ—¥å¿— | ç®€å• | è¯¦ç»† | GUIæ˜¾ç¤º |
| é…ç½®æ–¹å¼ | å‚æ•° | JSON+å‚æ•° | GUIè¾“å…¥ |
| æŽ¨èåœºæ™¯ | è°ƒè¯•åæ ‡ | æ­£å¼æŠ¢ç¥¨ | å¯è§†åŒ–æ“ä½œ |

---

## ðŸ› ï¸ å¸¸è§é—®é¢˜

### Q1: ç‚¹å‡»å¤±è´¥æ€Žä¹ˆåŠž?

**A**: å¢žåŠ é‡è¯•æ¬¡æ•°æˆ–ç­‰å¾…æ—¶é—´

```python
bot.retry_config['max_click_retries'] = 5  # é»˜è®¤3æ¬¡
bot.retry_config['click_wait'] = 3  # é»˜è®¤2ç§’
```

### Q2: ä¸­æ–‡è¾“å…¥ä¹±ç ?

**A**: ç¡®ä¿ä½¿ç”¨Appiumçš„`send_keys()`,ä¸è¦ç”¨ADBå‘½ä»¤ã€‚

### Q3: åœºæ¬¡/ç¥¨æ¡£é€‰æ‹©å¤±è´¥?

**A**: åæ ‡ä¸å‡†ç¡®,éœ€è¦æ‰‹åŠ¨æµ‹è¯•å¹¶æ›´æ–°ã€‚

```bash
# æµ‹è¯•åæ ‡
adb shell input tap X Y
```

### Q4: å¦‚ä½•ä¿®æ”¹åæ ‡?

**A**: ç¼–è¾‘ `damai_ticket_bot.py`,æ‰¾åˆ°åæ ‡é…ç½®éƒ¨åˆ†:

```python
self.coords = {
    "session_selector": (209, 435),  # ä¿®æ”¹è¿™é‡Œ
    "price_selector": (169, 659),    # ä¿®æ”¹è¿™é‡Œ
    "confirm_button": (558, 1233)    # ä¿®æ”¹è¿™é‡Œ
}
```

### Q5: å¦‚ä½•é›†æˆåˆ°çŽ°æœ‰GUI?

**A**: å‚è€ƒ **[é›†æˆæŒ‡å—.md](é›†æˆæŒ‡å—.md)**

---

## ðŸš§ å·²çŸ¥é™åˆ¶

1. **å›ºå®šåæ ‡**: ä¸åŒåˆ†è¾¨çŽ‡è®¾å¤‡éœ€è¦è°ƒæ•´
2. **æ»‘å—éªŒè¯**: éœ€è¦æ‰‹åŠ¨å¤„ç†
3. **åœºæ¬¡/ç¥¨æ¡£**: ä¸åŒæ¼”å‡ºå¸ƒå±€ä¸åŒ
4. **è®¢å•æäº¤**: ä¸è‡ªåŠ¨æäº¤,éœ€äººå·¥ç¡®è®¤

---

## ðŸ”® æœªæ¥ä¼˜åŒ–

### è¿‘æœŸè®¡åˆ’

- [ ] è‡ªåŠ¨æ»‘å—è¯†åˆ«
- [ ] OCRè¯†åˆ«æŒ‰é’®ä½ç½® (æ›¿ä»£å›ºå®šåæ ‡)
- [ ] åæ ‡è‡ªé€‚åº”ä¸åŒåˆ†è¾¨çŽ‡
- [ ] å®šæ—¶æŠ¢ç¥¨åŠŸèƒ½

### é•¿æœŸè®¡åˆ’

- [ ] æ™ºèƒ½é€‰åº§
- [ ] å¤šè´¦å·å¹¶å‘
- [ ] è®¢å•è‡ªåŠ¨æäº¤
- [ ] å¾®ä¿¡/é‚®ä»¶é€šçŸ¥
- [ ] Webç®¡ç†ç•Œé¢

---

## ðŸ“ž æŠ€æœ¯æ”¯æŒ

### é‡åˆ°é—®é¢˜?

è¯·æä¾›:
1. å®Œæ•´é”™è¯¯æ—¥å¿—
2. è®¾å¤‡ä¿¡æ¯ (`adb devices`)
3. é…ç½®æ–‡ä»¶å†…å®¹
4. æˆªå›¾ (å¦‚æœ‰)

### å‚è€ƒèµ„æ–™

- Appiumæ–‡æ¡£: https://appium.io/docs
- Seleniumæ–‡æ¡£: https://selenium-python.readthedocs.io

---

## âš–ï¸ å…è´£å£°æ˜Ž

æœ¬é¡¹ç›®ä»…ä¾›å­¦ä¹ ç ”ç©¶ä½¿ç”¨,ä½¿ç”¨è€…éœ€éµå®ˆå¤§éº¦å¹³å°çš„ç”¨æˆ·åè®®ã€‚
å› ä½¿ç”¨æœ¬è„šæœ¬å¯¼è‡´çš„ä»»ä½•åŽæžœ,ä½œè€…ä¸æ‰¿æ‹…è´£ä»»ã€‚

---

## ðŸ“ æ›´æ–°æ—¥å¿—

### v1.0 (2025-11-15)

**æ–°å¢ž**:
- âœ… å®Œæ•´æŠ¢ç¥¨æµç¨‹å®žçŽ°
- âœ… åŸºäºŽå®žé™…æµ‹è¯•çš„åæ ‡
- âœ… ä¸­æ–‡è¾“å…¥æ”¯æŒ
- âœ… é”™è¯¯å¤„ç†å’Œé‡è¯•æœºåˆ¶
- âœ… è¯¦ç»†æ—¥å¿—è¾“å‡º
- âœ… JSONé…ç½®æ–‡ä»¶
- âœ… å‘½ä»¤è¡Œå‚æ•°æ”¯æŒ
- âœ… ç‹¬ç«‹GUIç‰ˆæœ¬
- âœ… å®Œæ•´æ–‡æ¡£

**ä¿®å¤**:
- åŸŽå¸‚é€‰æ‹©æµç¨‹ (4æ­¥,éž3æ­¥)
- ä¸­æ–‡è¾“å…¥æ–¹æ³• (ä½¿ç”¨Appium)

**ä¼˜åŒ–**:
- å¼‚å¸¸å¤„ç†æ›´å®Œå–„
- æ—¥å¿—è¾“å‡ºæ›´å‹å¥½
- é…ç½®æ›´çµæ´»

---

## ðŸ™ è‡´è°¢

æ„Ÿè°¢æ‰‹æŠŠæ‰‹æ•™å­¦å®Œæ•´æŠ¢ç¥¨æµç¨‹!

---

**ç‰ˆæœ¬**: v1.0
**æ—¥æœŸ**: 2025-11-15
**ä½œè€…**: Claude Code

**ç¥æŠ¢ç¥¨æˆåŠŸ!** ðŸŽ‰
